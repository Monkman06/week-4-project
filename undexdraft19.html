<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Force off week 4 game</title>

  <script src="https://code.jquery.com/jquery-2.2.3.js" integrity="sha256-laXWtGydpwqJ8JA+X9x2miwmaiKhn8tVmOVEigRNtP4=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
 <body background="ATATpic.jpg">
  <font face="times" color="yellow"><h1><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Light vs Dark Force-Off </h1></strong></font></style>


  <div class="row" id="playersAvailable">

    <div class="col-xs-2">
      <a href="#" 
         class="thumbnail thumbnail1" 
         id="kylo-ren">
        <img src="kylo-ren.jpg" alt="kylo-ren">
        Kylo Ren 125
      </a>
    </div>

    <div class="col-xs-2">
      <a href="#" class="thumbnail thumbnail2" id="generalhux">
        <img src="generalhux.jpg" alt="generalhux">
        General Hux 90
      </a>
    </div>

    <div class="col-xs-2">
      <a href="#" class="thumbnail thumbnail3" id="finn">
        <img src="finn.jpg" alt="finn">
        Finn 100
      </a>
    </div>

    <div class="col-xs-2">
      <a href="#" class="thumbnail thumbnail4" id="rey">
        <img src="rey.jpg" alt="rey">Rey 150
      </a>
    </div>

  </div>

  <!-- Container for Your Character -->
    <div class="row">
      <div class="col-xs-2">Your Character
         <a href="#" 
           class="thumbnail" 
           id="player">

         </a>
     </div>
    </div>
  <!-- Container for Enemies Available -->
    <div class="row" id="enemiesAvailable">Enemies Available to Attack:</div>

  <!-- FIGHT SECTION -->
    <div class="fightSection">
            <button class="btn btn-default btn-xs attackButton">Attack</button>
    </div>

    <!-- Container for Your Defender -->
    <div class="row">
      <div class="col-xs-2">The Defender
         <a href="#" 
           class="thumbnail" 
           id="defender">

         </a>
      </div>
    </div>


    <script type="text/javascript" src="assets/javascript/game.js">

var starwars = {

  player: "", // set to a character once chosen by the user

  character = {
    name: "",  // May not be needed for anything more than debugging
    healthPoints: 0,
    attackPower: 0,
    counterAttack Power: 0,

  testfunc: funtion() {

  }
  
  attack: function() {

  },

  counterAttack: function {

  }
}
    $(document).ready(function(){

        $(".thumbnail1").on("click", function(){
                    $("#1").animate({opacity: '.5'});
                });
        $(".thumbnail2").on("click", function(){
                    $("#2").animate({width: '500px'});
                });
        $(".thumbnail3").on("click", function(){
                    $("#three").animate({right: '500px'});
                });
        $(".thumbnail4").on("click", function(){
                    $("#4").animate({height: '500px'});
                });
     })

     
  newGame: 1, 
  playerSelected: 2, 
  defenderSelected: 3,
  attacking: 4,
  gameLost: 5,
  enemyDefeated: 6,
  gameWon: 7,

  state: this.newGame,

  player: {},   // set to the first character selected by the user
  playerId: "", // used to find the player in the list of playersAvailable  
  defender: {}, // set to the next character selected by the user
  defenderId: "", // used to find the defender in the list of playersAvailable

  playersAvailable: {},
  enemiesAvailable: {},

  playerCount: 0,

  // Reset the game.
  initGame: function() {
    this.state = this.newGame;
    this.player = {}, // may need to use clear() function here
    this.defender = {},

    this.loadPlayersAvailable();
    this.clearEnemiesAvailable();

//    this.playerCount = this.playersAvailable.length;
    this.playerCount = 4;
  },

  // Build the html to display all the characters available 
  // in the player section.  This will display all the characters
  // in the game regardless of when this method is called.
  loadPlayersAvailable: function() {
    this.playersAvailable = {
      'darthvader': { name: 'Darth Vader', healthPoints: 120, basePower: 10, attackPower: 0 },      
      'lukeskywalker': { name: 'Luke Skywalker', healthPoints: 100, basePower: 20, attackPower: 0 },      
      'stormtrooper': { name: 'Storm Trooper', healthPoints: 150, basePower: 30, attackPower: 0 },      
      'yoda': { name: 'Yoda', healthPoints: 100, basePower: 40, attackPower: 0 }      
    };


  },

  loadEnemiesAvailable: function() {

  },

  clearEnemiesAvailable: function() {

  },

  setPlayer: function(player) {
    
    this.playerId = player.id;

    this.player = this.playersAvailable[this.playerId];

    // Move the selected player to the player area
    $('#' + this.playerId).remove();

    // Get the player div
    var playerDiv = $('#player');

    // Add a div for the name of the player selected
    playerDiv.append('<div>' + this.player.name + '</div>');

    // Add an image for the player selected
    var playerImg = $('<img>');
    playerImg.attr('src', 'assets/images/' + this.playerId + '.jpg');
    playerImg.attr('alt', this.playerId);
    playerDiv.append(playerImg);

    playerDiv.append('<div id="player-health">' + this.player.healthPoints);

    this.playerCount--;
    this.state = this.playerSelected;
  },

  setDefender: function(defender) {
    this.defenderId = defender.id;

    this.defender = this.playersAvailable[this.defenderId];

    
    $('#' + this.defenderId).remove();
   
    var defenderDiv = $('#defender');

    defenderDiv.append('<div>' + this.defender.name + '</div>');

    var defenderImg = $('<img>');
    defenderImg.attr('src', 'assets/images/' + this.defenderId + '.jpg');
    defenderImg.attr('alt', this.defenderId);
    defenderDiv.append(defenderImg);

    // Add a div for the health points of the player selected
    defenderDiv.append('<div id="player-health">' + this.defender.healthPoints);

    this.playerCount--;
    this.state = this.defenderSelected;
  },

  attack: function() {
    // this will be called whenever the attack button is clicked.
    console.log("starwars.play: attack button pressed");

    if (this.state != this.attacking) {
      if (this.state != this.defenderSelected) {
        // ignore the attack button, the defender must be selected first
        return;
      }
      this.state = this.attacking;
    }

    
    if (this.player.healthPoints <= 0) {
      this.state = this.GameLost;
      return;
    }

    this.player.attackPower += this.player.basePower;

    if (this.defender.healthPoints > 0) {
      this.defender.healthPoints -= this.player.attackPower;
    }

    if (this.defender.healthPoints <= 0) {
//      if ($('#playersAvailable').children('.thumbnail').length > 0) {
      if (this.playerCount > 0) {
        this.state = this.enemyDefeated;  // need to select another defender
        $('#defender').children(0).remove();
      }
      else {
        this.state = this.gameWon;
      }
    }
    else {
      this.counterAttack();
    }

    // Update defender's HP below image
    console.log("Defender HP: " + this.defender.healthPoints);
    $('#defender').children('#player-health').text(this.defender.healthPoints);
  },

  counterAttack: function() {
   
     console.log("method: counterAttack() called");

     this.player.healthPoints -= this.defender.basePower;

     if (this.player.healthPoints <= 0) {
      this.state = this.gameLost;
     }

     // Update the player's healthpoints below it's picture
     console.log("Player's HP: " + this.player.healthPoints);
    $('#player').children('#player-health').text(this.player.healthPoints);
  },

} // end of starwars game object

// This function will be call upon a user event
//
$(document).ready(function(){

  starwars.initGame();

  $(".thumbnail").on("click", function(){
    

    if (starwars.state == starwars.newGame){
      starwars.setPlayer(this);
    }
    else if (starwars.state == starwars.playerSelected) {
      starwars.setDefender(this);
    }
    else if (starwars.state == starwars.enemyDefeated) {
      starwars.setDefender(this);
    }
    else if (starwars.state == starwars.defenderSelected ||
         starwars.state == starwars.attacking ||
         starwars.state == starwars.gameLost ||
         starwars.state == starwars.gameWon) {
      // ignore for now
    }
    else {
      console.log("Unable to select a character.  Invalid state: " + starwars.state);
    }
    });

    $(".attackButton").on("click", function(){
      starwars.attack();

      if (starwars.state == starwars.gameWon) {
        alert("Game Won!!");
        starwars.initGame();
      }
      else if (starwars.state == starwars.gameLost) {
        alert("Game Lost!!");
        starwars.initGame();
      }
      else if (starwars.state == starwars.enemyDefeated) {
        alert("Enemy Defeated!!  Choose another Enemy!");
      }
      else {
        console.log("Invalid state for Attacking: " + starwars.state);
      }
    });
})
    </script>
</body>
</html>
